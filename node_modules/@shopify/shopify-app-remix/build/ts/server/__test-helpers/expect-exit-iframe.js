"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.expectExitIframeRedirect = void 0;
var const_1 = require("./const");
function expectExitIframeRedirect(response, _a) {
    var _b = _a === void 0 ? {} : _a, _c = _b.shop, shop = _c === void 0 ? const_1.TEST_SHOP : _c, _d = _b.host, host = _d === void 0 ? const_1.BASE64_HOST : _d, _e = _b.destination, destination = _e === void 0 ? "/auth?shop=".concat(shop) : _e, _f = _b.addHostToExitIframePath, addHostToExitIframePath = _f === void 0 ? true : _f;
    expect(response.status).toBe(302);
    var _g = new URL(response.headers.get('location'), const_1.APP_URL), pathname = _g.pathname, searchParams = _g.searchParams;
    expect(pathname).toBe('/auth/exit-iframe');
    expect(searchParams.get('shop')).toBe(shop);
    var expectedDestination = destination;
    if (host) {
        expect(searchParams.get('host')).toBe(host);
        if (addHostToExitIframePath) {
            expectedDestination = destination.concat("&host=".concat(host));
        }
    }
    expect(searchParams.get('exitIframe')).toBe(expectedDestination);
}
exports.expectExitIframeRedirect = expectExitIframeRedirect;
//# sourceMappingURL=expect-exit-iframe.js.map