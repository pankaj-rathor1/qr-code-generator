"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.unauthenticatedStorefrontContextFactory = void 0;
var tslib_1 = require("tslib");
var errors_1 = require("../../errors");
var storefront_1 = require("../../clients/storefront");
var helpers_1 = require("../helpers");
function unauthenticatedStorefrontContextFactory(params) {
    var _this = this;
    return function (shop) { return tslib_1.__awaiter(_this, void 0, void 0, function () {
        var session;
        return tslib_1.__generator(this, function (_a) {
            switch (_a.label) {
                case 0: return [4 /*yield*/, (0, helpers_1.getOfflineSession)(shop, params)];
                case 1:
                    session = _a.sent();
                    if (!session) {
                        throw new errors_1.SessionNotFoundError("Could not find a session for shop ".concat(shop, " when creating unauthenticated storefront context"));
                    }
                    return [2 /*return*/, {
                            session: session,
                            storefront: (0, storefront_1.storefrontClientFactory)({ params: params, session: session }),
                        }];
            }
        });
    }); };
}
exports.unauthenticatedStorefrontContextFactory = unauthenticatedStorefrontContextFactory;
//# sourceMappingURL=factory.js.map